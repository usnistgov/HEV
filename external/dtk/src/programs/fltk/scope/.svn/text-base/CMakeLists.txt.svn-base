# CMakeLists.txt to build programs/fltk/scope

IF( WIN32 )
	SET( WIN32_EXTRA_LIBS "comctl32.lib ws2_32.lib" )
ENDIF( WIN32 )

INCLUDE_DIRECTORIES( ${DTK_SOURCE_DIR}/include ${DTK_FLTK_INC_DIRS} )
LINK_DIRECTORIES( ${DTK_FLTK_LINK_DIRS} )

ADD_EXECUTABLE( dtk-doubleScope MACOSX_BUNDLE canvas.cpp channel.cpp
		channelWidget.cpp checkRates.cpp colorButton.cpp controls.cpp
		dtk-floatScope.cpp mainWin.cpp parseArgs.cpp plot.cpp plotWidget.cpp
		usage.cpp )
TARGET_LINK_LIBRARIES( dtk-doubleScope dtk ${DTK_FLTK_LIBS} )
SET_TARGET_PROPERTIES( dtk-doubleScope PROPERTIES
		LINK_FLAGS "${DTK_FLTK_LINK_FLAGS}"
		COMPILE_FLAGS -DdoubleScope )
IF( ${DTK_ARCH_UPPER} MATCHES "DARWIN" )
	SET( CUR_TARGET dtk-doubleScope )
	CONFIGURE_FILE( ${DTK_SOURCE_DIR}/programs/fltk/prog2app.in ${CMAKE_CURRENT_BINARY_DIR}/prog2app${CUR_TARGET} @ONLY )
	ADD_CUSTOM_COMMAND( TARGET ${CUR_TARGET} POST_BUILD COMMAND mv prog2app${CUR_TARGET} ${CUR_TARGET} COMMAND chmod +x ${CUR_TARGET} VERBATIM )
	INSTALL( PROGRAMS ${CMAKE_CURRENT_BINARY_DIR}/${CUR_TARGET} DESTINATION bin PERMISSIONS
		OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ
		WORLD_EXECUTE )
ENDIF( ${DTK_ARCH_UPPER} MATCHES "DARWIN" )

ADD_EXECUTABLE( dtk-floatScope MACOSX_BUNDLE canvas.cpp channel.cpp channelWidget.cpp
	checkRates.cpp colorButton.cpp controls.cpp dtk-floatScope.cpp mainWin.cpp
	parseArgs.cpp plot.cpp plotWidget.cpp usage.cpp )
TARGET_LINK_LIBRARIES( dtk-floatScope dtk ${DTK_FLTK_LIBS} )
SET_TARGET_PROPERTIES( dtk-doubleScope PROPERTIES
		LINK_FLAGS "${DTK_FLTK_LINK_FLAGS}" )
IF( ${DTK_ARCH_UPPER} MATCHES "DARWIN" )
	SET( CUR_TARGET dtk-floatScope )
	CONFIGURE_FILE( ${DTK_SOURCE_DIR}/programs/fltk/prog2app.in ${CMAKE_CURRENT_BINARY_DIR}/prog2app${CUR_TARGET} @ONLY )
	ADD_CUSTOM_COMMAND( TARGET ${CUR_TARGET} POST_BUILD COMMAND mv prog2app${CUR_TARGET} ${CUR_TARGET} COMMAND chmod +x ${CUR_TARGET} VERBATIM )
	INSTALL( PROGRAMS ${CMAKE_CURRENT_BINARY_DIR}/${CUR_TARGET} DESTINATION bin PERMISSIONS
		OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE WORLD_READ
		WORLD_EXECUTE )
ENDIF( ${DTK_ARCH_UPPER} MATCHES "DARWIN" )

SET_TARGET_PROPERTIES( dtk-doubleScope dtk-floatScope PROPERTIES COMPILE_FLAGS
	"${DTK_FLTK_CXXFLAGS}" LINK_FLAGS "${WIN32_EXTRA_LIBS}" )
INSTALL( TARGETS dtk-doubleScope dtk-floatScope RUNTIME DESTINATION bin
	PERMISSIONS OWNER_READ OWNER_WRITE OWNER_EXECUTE GROUP_READ GROUP_EXECUTE
	WORLD_READ WORLD_EXECUTE )

